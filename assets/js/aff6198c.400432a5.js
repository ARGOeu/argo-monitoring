"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6507],{9654:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var s=i(4848),o=i(8453);const r={sidebar_position:2,title:"Guidelines for monitoring probes"},t=void 0,l={id:"monitoring/guidelines",title:"Guidelines for monitoring probes",description:"Overview",source:"@site/docs/monitoring/guidelines.md",sourceDirName:"monitoring",slug:"/monitoring/guidelines",permalink:"/argo-monitoring/docs/monitoring/guidelines",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Guidelines for monitoring probes"},sidebar:"tutorialSidebar",previous:{title:"Monitoring guide for Service Providers",permalink:"/argo-monitoring/docs/monitoring/SP_guide"},next:{title:"Profiles",permalink:"/argo-monitoring/docs/category/profiles"}},a={},c=[{value:"Overview",id:"overview",level:2},{value:"Development",id:"development",level:2},{value:"Actual Data",id:"actual-data",level:3},{value:"Packaging",id:"packaging",level:2},{value:"Integration, Testing and Deployment",id:"integration-testing-and-deployment",level:2},{value:"Testing",id:"testing",level:3},{value:"Deployment",id:"deployment",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This document describes the policy to develop, package and integrate new probes into the ARGO Monitoring Engine."}),"\n",(0,s.jsx)(n.h2,{id:"development",children:"Development"}),"\n",(0,s.jsxs)(n.p,{children:["Before starting with development, check if probe already exists on ",(0,s.jsx)(n.a,{href:"https://exchange.nagios.org/",children:"Nagios Exchange"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Please refer to the official Nagios documentation for probe development guidelines:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://nagios-plugins.org/doc/guidelines.html",children:"Nagios Development Guidelines"}),","]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/4/en/pluginapi.html",children:"Nagios Plugin API"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Probes can be developed in any of these languages:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Python,"}),"\n",(0,s.jsxs)(n.li,{children:["Perl - in case of Perl use of module ",(0,s.jsx)(n.code,{children:"Nagios::Plugin"})," is highly recommended,"]}),"\n",(0,s.jsx)(n.li,{children:"C/C++,"}),"\n",(0,s.jsx)(n.li,{children:"shell scripting (Bash, Bourne)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"ARGO Monitoring engine currently supports RHEL 7 and derivatives, so probes should use language versions and libraries provided for these distributions."}),"\n",(0,s.jsxs)(n.p,{children:["List of existing probes can be found in ",(0,s.jsx)(n.a,{href:"https://poem.argo.grnet.gr/ui/public_probes/",children:"POEM"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Some other conditions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Each probe ",(0,s.jsx)(n.strong,{children:"must"})," provide the following arguments:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"-h help (--help)\n-t timeout (--timeout)\n-H hostname (--hostname)\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The following arguments can also be used if applicable:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"-p port (--port)\n-u url (--url)\n-v verbose (--verbose)\n-w warning threshold (--warning)\n-c critical threshold (--critical)\n-u username (--username)\n-p password (--password)\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Maximum output size for test/plugin output is 16KB. Above that limit the output will be truncated."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"actual-data",children:"Actual Data"}),"\n",(0,s.jsxs)(n.p,{children:["Actual data is additional information about service behaviour that can be used in combination with threshold mechanisms to generate new metrics. Probes can report actual data by following the ",(0,s.jsx)(n.a,{href:"https://nagios-plugins.org/doc/guidelines.html#AEN200",children:"Nagios guidelines for performance data"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Some other conditions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"This is the expected format of actual data:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"'label'=value[UOM];[warn];[crit];[min];[max]\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"packaging",children:"Packaging"}),"\n",(0,s.jsx)(n.p,{children:"Probes must be provided in the form of RPM packages, where a single package may contain multiple probes. Please refer to the official EPEL documentation for packaging:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"http://fedoraproject.org/wiki/EPEL/GuidelinesAndPolicies",children:"EPEL Guidelines And Policies"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Some considerations about naming:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Package should ",(0,s.jsx)(n.strong,{children:"ensure a unique namespace by using tenant, project (e.g. egi, eudat, argo) or product team (e.g. cream, htcondor) name"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Package name should use\n",(0,s.jsx)(n.code,{children:'"argo-probe-<project|organisation|team>-<service_name>"'})," form"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["where ",(0,s.jsx)(n.code,{children:"<service_name>"})," is the name of the service probes are testing (e.g. argo-probe-grnet-agora). For more generic probes (not project specific) name ",(0,s.jsx)(n.code,{children:'"argo-probe-<service_type>"'})," is also acceptable (e.g. argo-probe-webdav)."]}),"\n",(0,s.jsx)(n.p,{children:"Some considerations about structure:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Probes should be stored in directory:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/usr/libexec/argo/probes/"})," (For more generic probes (not project specific) directory used by EPEL nagios probes (",(0,s.jsx)(n.code,{children:"/usr/lib64/nagios/plugins/"}),") is also acceptable.)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["If probes create temporary files, package should create directory:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/var/spool/argo/probes/<probe_namespace>/"})," with ownership nagios",":nagios"," and permissions 750."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["If probes package contains configuration files, they should be stored in directory:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/etc/argo/probes/<probe_namespace>/"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Some considerations about dependencies management:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Each probe is responsible for handling its dependencies."}),"\n",(0,s.jsx)(n.li,{children:"The environment needed to execute each probe must be defined by the probe."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"integration-testing-and-deployment",children:"Integration, Testing and Deployment"}),"\n",(0,s.jsxs)(n.p,{children:["Each ",(0,s.jsx)(n.code,{children:"<tenant|project|product team>"})," develops and tests its own probes in their development environments. Pre-requirements for the integration and testing of probes are:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Each ",(0,s.jsx)(n.code,{children:"<tenant|project|product team>"})," publishes probe(s) on an accessible:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Git repository with a valid RPM spec file;"}),"\n",(0,s.jsx)(n.li,{children:"Yum repository with RPM packages."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Each probe provides an accessible web page with the relevant documentation."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Integration of new probes starts with adding above information into ",(0,s.jsx)(n.a,{href:"http://argoeu.github.io/poem/v1/",children:"POEM"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,s.jsx)(n.p,{children:"Testing consists of the following steps:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If the probe is provided in Git repository ARGO will clone it and attempt to build the package."}),"\n",(0,s.jsx)(n.li,{children:"ARGO will deploy the RPM package, test and validate the new probe."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,s.jsx)(n.p,{children:"Deployment consists of the following steps:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ARGO in cooperation with the Service owner defines metric templates performed by the new probe in POEM."}),"\n",(0,s.jsx)(n.li,{children:"ARGO in cooperation with the Service owner adds mappings between service flavours and metrics in POEM."}),"\n",(0,s.jsx)(n.li,{children:"ARGO in cooperation with the Service owner follows project\u2019s procedures for deployment to production."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const o={},r=s.createContext(o);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);